<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PrimeSnapsX</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- IMPORTANT: data.js file ko yahan link karna hai -->
  <script src="data.js"></script>
  <style>
    body { background-color: #ffffff; font-family: 'Segoe UI', sans-serif; }
    .hidden { display: none; }
    #page-content { transition: filter 0.3s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    .modal-content { animation: fadeIn 0.3s ease-out forwards; }
  </style>
</head>
<body class="bg-white">

<div id="app" class="w-full max-w-4xl mx-auto">
  <header class="bg-blue-600 text-white p-4 flex justify-between items-center shadow-md">
    <h1 class="text-2xl font-bold">PrimeSnapsX</h1>
    <div class="flex items-center space-x-4">
      <i class="fas fa-search cursor-pointer"></i>
      <div class="flex items-center space-x-2 cursor-pointer"><i class="fas fa-bars"></i><span>Menu</span></div>
    </div>
  </header>

  <div id="page-content">
    <div class="p-2 md:p-4">
        <h2 id="video-title" class="text-2xl font-bold text-gray-800 mb-3">Loading Video...</h2>
        <div class="aspect-video bg-black rounded-lg overflow-hidden shadow-lg border border-gray-200">
          <video id="player" class="w-full h-full" controls playsinline webkit-playsinline crossorigin="anonymous"></video>
        </div>
        <div class="text-center my-4">
            <p class="text-red-600 font-bold text-lg">If Video not Load Please Watch on server 2</p>
            <a id="server2Btn" href="#" class="inline-block mt-2 px-8 py-3 bg-green-500 text-white font-bold text-lg rounded-md hover:bg-green-600">Play on Server 2</a>
        </div>
    </div>
  </div>

  <div id="unlockModal" role="dialog" class="fixed inset-0 flex items-center justify-center z-50 hidden">
    <div class="absolute inset-0 bg-black bg-opacity-70 backdrop-blur-md"></div>
    <div class="modal-content relative bg-gray-800 rounded-xl p-8 z-10 text-center shadow-2xl mx-4">
      <p class="mb-6 text-lg text-gray-200">After unlocking this video, if you don't find the video, please come back to this page.</p>
      <a id="unlockBtn" href="#" class="inline-block px-8 py-3 bg-pink-600 text-white font-bold rounded-lg" target="_blank" rel="noopener noreferrer">Unlock Full Video</a>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const VIDEO_ID = urlParams.get('id');
    
    // Elements ko select karo
    const player = document.getElementById('player');
    const videoTitleEl = document.getElementById('video-title');
    const server2Btn = document.getElementById('server2Btn');
    const unlockBtn = document.getElementById('unlockBtn');
    const pageContent = document.getElementById('page-content');
    const modal = document.getElementById('unlockModal');
    
    // data.js se video ki details nikalo
    const videoData = videos[VIDEO_ID];

    if (videoData) {
        // Agar video mila, to page par details daalo
        document.title = videoData.title;
        videoTitleEl.textContent = videoData.title;
        player.src = videoData.videoLink;
        player.poster = videoData.posterLink;
        server2Btn.href = videoData.server2Link;
        unlockBtn.href = videoData.adultLink;

        // --- POPUP LOGIC (100% Works) ---
        const SESSION_KEY = `popup_shown_${VIDEO_ID}`;
        const REQUIRED_MILLISECONDS = 60000; // 1 Minute

        function showModal() {
            localStorage.setItem(SESSION_KEY, 'true');
            pageContent.style.filter = 'blur(8px)';
            modal.classList.remove('hidden');
            if (!player.paused) { player.pause(); }
        }
        
        if (!localStorage.getItem(SESSION_KEY)) {
            console.log("Popup timer started for 1 minute.");
            setTimeout(showModal, REQUIRED_MILLISECONDS);
        } else {
            console.log("Popup was already shown. No timer started.");
        }
    } else {
        // Agar video nahi mila, to error dikhao
        videoTitleEl.textContent = "Error: Video Not Found";
        pageContent.innerHTML += `<p class="text-center text-red-500">The video ID in the URL is incorrect.</p>`;
    }
});
</script>

</body>
</html>
